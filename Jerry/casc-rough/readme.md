# This is just a rough implementation transfered from R
